{"version":3,"file":"index.js","sources":["../../src/node/logger.ts","../../src/node/watermarkPlugin.ts"],"sourcesContent":["import { Logger } from '@vuepress/helper'\n\nexport const PLUGIN_NAME = '@vuepress/plugin-watermark'\n\nexport const logger = new Logger(PLUGIN_NAME)\n","import type { Plugin } from 'vuepress/core'\nimport { isFunction } from 'vuepress/shared'\nimport { getDirname, path } from 'vuepress/utils'\nimport { PLUGIN_NAME, logger } from './logger.js'\nimport type { WatermarkPluginOptions } from './options.js'\n\nconst __dirname = import.meta.dirname || getDirname(import.meta.url)\n\n/**\n * VuePress watermark plugin\n *\n * VuePress 水印插件\n *\n * @param options - Plugin options / 插件选项\n *\n * @example\n * ```ts\n * import { watermarkPlugin } from '@vuepress/plugin-watermark'\n *\n * export default {\n *   plugins: [\n *     watermarkPlugin({\n *       enabled: true,\n *       watermarkOptions: {\n *         content: 'My Site',\n *         fontColor: '#666',\n *         opacity: 0.3,\n *       },\n *     }),\n *   ],\n * }\n * ```\n */\nexport const watermarkPlugin =\n  ({ enabled = true, ...options }: WatermarkPluginOptions = {}): Plugin =>\n  (app) => {\n    if (app.env.isDebug) logger.info('Options:', options)\n\n    return {\n      name: PLUGIN_NAME,\n\n      define: {\n        __WM_GLOBAL__: enabled === true,\n        __WM_OPTIONS__: options.watermarkOptions ?? {},\n      },\n\n      extendsPage: (page) => {\n        // When watermark is a filter function, enable watermark for matching pages.\n        if (isFunction(enabled)) {\n          const { frontmatter } = page\n\n          if (!('watermark' in frontmatter) && enabled(page)) {\n            frontmatter.watermark = true\n          }\n        }\n      },\n\n      clientConfigFile: path.resolve(__dirname, '../client/config.js'),\n    }\n  }\n"],"names":["PLUGIN_NAME","logger","Logger","__dirname","getDirname","watermarkPlugin","enabled","options","app","page","isFunction","frontmatter","path"],"mappings":"6IAEO,MAAMA,EAAc,6BAEdC,EAAS,IAAIC,EAAOF,CAAW,ECEtCG,EAAY,YAAY,SAAWC,EAAW,YAAY,GAAG,EA2BtDC,EACX,CAAC,CAAE,QAAAC,EAAU,GAAM,GAAGC,CAAQ,EAA4B,CAAA,IACzDC,IACKA,EAAI,IAAI,SAASP,EAAO,KAAK,WAAYM,CAAO,EAE7C,CACL,KAAMP,EAEN,OAAQ,CACN,cAAeM,IAAY,GAC3B,eAAgBC,EAAQ,kBAAoB,CAAA,CAC9C,EAEA,YAAcE,GAAS,CAErB,GAAIC,EAAWJ,CAAO,EAAG,CACvB,KAAM,CAAE,YAAAK,CAAY,EAAIF,EAEpB,EAAE,cAAeE,IAAgBL,EAAQG,CAAI,IAC/CE,EAAY,UAAY,GAE5B,CACF,EAEA,iBAAkBC,EAAK,QAAQT,EAAW,qBAAqB,CACjE"}